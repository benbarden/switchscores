{% extends 'theme/wos/base.twig' %}
{% import "ui/components/headings/heading.twig" as heading %}

{% block page_body %}

<div class="row">

    <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">

        {% if CategoryList %}
            <table class="table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th class="text-center">No of games</th>
                    </tr>
                </thead>
                <tbody>
                {% for item in CategoryList %}
                    <tr>
                        <td>
                            <h2 style="font-size: 20px; margin: 5px 0;">
                                <a href="{{ route('console.byCategory.page', {'console': Console, 'category': item.link_title}) }}">
                                    {{ item.name }}
                                </a>
                            </h2>
                        </td>
                        <td class="text-center">
                            <h2 style="font-size: 20px; margin: 5px 0;">
                                {% if Console.id == 1 %}
                                    {{ item.gamesSwitch1.count }}
                                {% elseif Console.id == 2 %}
                                    {{ item.gamesSwitch2.count }}
                                {% endif %}
                            </h2>
                        </td>
                    </tr>
                    {% if item.children %}
                        {% for itemChild in item.children %}
                            {% if Console.id == 1 %}
                                {% set gamesCount = itemChild.gamesSwitch1.count %}
                            {% elseif Console.id == 2 %}
                                {% set gamesCount = itemChild.gamesSwitch2.count %}
                            {% else %}
                                {% set gamesCount = 0 %}
                            {% endif %}
                            {% if gamesCount > 0 %}
                                <tr>
                                    <td>
                                        <i class="fa fa-chevron-right" aria-hidden="true"></i>
                                        <a href="{{ route('console.byCategory.page', {'console': Console, 'category': itemChild.link_title}) }}">
                                            {{ itemChild.name }}
                                        </a>
                                    </td>
                                    <td class="text-center">
                                        {{ gamesCount }}
                                    </td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No categories found!</p>
        {% endif %}

    </div>
    <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">

        {{ heading.renderChunky('Search games', 'h4') }}
        {% include 'ui/components/search/form-mini.twig' %}

        {{ heading.renderChunky('Browse all games', 'h4') }}
        {% include 'ui/components/navigation/nav-right-browse-all.twig' %}

    </div>
</div>

{% endblock page_body %}
