{% extends 'theme/wos/reviewers/clean-wide.twig' %}
{% set hideHeader = 'Y' %}

{% block page_inner %}

    <div class="row member-dashboard">

        <div class="col-xs-12 col-sm-8 col-md-8">
            <h1>{{ PageTitle }}</h1>

            {% if ShowNewSignup %}
                <div class="alert alert-success">
                    <strong>Thanks for signing up at Switch Scores!</strong> As you used a special invite code,
                    we've been able to take you right to the reviewers dashboard.
                    Please send questions or feedback to Ben via
                    <a href="https://twitter.com/switchscores" target="_blank">Twitter</a> or
                    <a href="mailto:ben@switchscores.com">email</a>.
                </div>
            {% else %}
                <p>
                    Thanks for checking out the Reviewers dashboard!
                    Please send questions or feedback to Ben via
                    <a href="https://twitter.com/switchscores" target="_blank">Twitter</a> or
                    <a href="mailto:ben@switchscores.com">email</a>.
                </p>
            {% endif %}

            <h2>What to review next</h2>
            <h3>Campaigns</h3>
            <p>
                These are games we'd love to see reviews of next.
                Help to get more of our database ranked - pick a campaign and jump right in!
            </p>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12">
                    {% include 'modules/campaigns/dashboard-block.twig' with {'SiteRole': 'reviewer'} %}
                </div>
            </div>
            <h3 style="margin-top: 0;">Unranked games</h3>
            <p>
                You can find all of our unranked games below. Quickly find the games that only need 1 or 2
                reviews to get ranked.
            </p>
            <p>
                <a href="{{ route('reviewers.unranked-games.list', {'mode': 'by-count', 'filter': '2'}) }}" class="btn btn-primary btn-md">View unranked games</a>
            </p>

        </div>

        <div class="col-xs-12 col-sm-4 col-md-4">

            {% include 'modules/tables/slick-header-spaced.twig' with {'titleText': 'Your details'} %}
            <p>
                Fill out your details so publishers and developers can contact you with review codes.
                Only publishers and developers will be able to view your contact details.
            </p>
            <table class="table table-condensed table-responsive">
                <tr>
                    <td>
                        <span style="font-weight: bold;">Website URL</span>
                    </td>
                    <td>
                        <a href="{{ PartnerData.website_url }}" target="_blank">Visit site</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span style="font-weight: bold;">Twitter ID</span>
                    </td>
                    <td>
                        {% if PartnerData.twitter_id %}
                            <a href="https://twitter.com/{{ PartnerData.twitter_id }}" target="_blank">{{ PartnerData.twitter_id }}</a>
                        {% else %}
                            <p><em>None!</em></p>
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td>
                        <span style="font-weight: bold;">Contact name</span>
                    </td>
                    <td>{{ PartnerData.contact_name }}</td>
                </tr>
                <tr>
                    <td>
                        <span style="font-weight: bold;">Contact method</span>
                    </td>
                    <td>
                        {% if PartnerData.contact_email %}
                            <a href="mailto:{{ PartnerData.contact_email }}">{{ PartnerData.contact_email }}</a>
                        {% elseif PartnerData.contact_form_link %}
                            <a href="{{ PartnerData.contact_form_link }}" target="_blank">Contact form</a>
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td>
                        <span style="font-weight: bold;">Review code regions</span>
                    </td>
                    <td>{{ PartnerData.review_code_regions }}</td>
                </tr>
            </table>
            <a class="btn btn-primary" href="{{ route('reviewers.profile.edit') }}">Edit details</a>
            <a class="btn btn-primary" href="{{ route('reviews.site', {'linkTitle': PartnerData.link_title}) }}" target="_blank">View profile</a>
            <br>
            <br>

            {% include 'modules/tables/slick-header-spaced.twig' with {'titleText': 'Your stats'} %}
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-4 text-center">
                    <h2>
                        {{ PartnerData.review_count }}
                        <br>
                        <span class="h4">reviews</span>
                    </h2>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-4 text-center">
                    <h2>
                        {{ ReviewAvg }}
                        <br>
                        <span class="h4">average</span>
                    </h2>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-4 text-center">
                </div>
            </div>

        </div>

    </div>

    <div class="row member-dashboard">

        <div class="col-xs-12 col-sm-8 col-md-8">

            <h2>
                Draft reviews
            </h2>

            {#
            <p>
                Here you will find the reviews we've not been able to import automatically, usually
                because they are missing a score. Fill in the missing details and the review will be
                imported within 24 hours.
            </p>
            <p>
                This is also where you can add any reviews we may have missed. If you have a lot to add,
                get in touch as we can help you with a bulk import.
            </p>
            #}
            <p>
                This is where you can add any reviews we may have missed. If you have a lot to add,
                get in touch as we can help you with a bulk import.
            </p>
            <p>
                Soon we'll also give you the option to fill in missing information - such as the score -
                from reviews we import via an RSS feed.
            </p>

            <a href="{{ route('reviewers.review-feed-item.find-game') }}" class="btn btn-primary btn-sm">Add a review</a>

        </div>

        <div class="col-xs-12 col-sm-4 col-md-4">

            {% if FeedItemsPending.count > 0 %}
                <h3>Awaiting import</h3>
                {% include 'reviewers/reviews/feed-item/table-pending.twig' with {'FeedItems': FeedItemsPending} %}
            {% endif %}

        </div>

    </div>

    <div class="row member-dashboard">

        <div class="col-xs-12 col-sm-8 col-md-8">

            <h2>
                Recent imports
            </h2>
            {% if PartnerData.rating_scale != 10 %}
                <p>
                    <small>
                        As your site does not rank games out of 10, we have converted all ratings to
                        the equivalent score out of 10.
                    </small>
                </p>
            {% endif %}
            <div class="row">

                <div class="col-md-12">

                    <div id="tabs">

                        <ul>
                            <li><a href="#tabs-feed-items-success">Success ({{ FeedItemsSuccess.count }})</a></li>
                            <li><a href="#tabs-feed-items-failed">Failed ({{ FeedItemsFailed.count }})</a></li>
                        </ul>

                        <div id="tabs-feed-items-success">
                            {% include 'reviewers/reviews/feed-item/table.twig' with {'FeedItems': FeedItemsSuccess} %}
                            <a href="{{ route('reviewers.reviews.landing') }}">View all &gt;</a>
                        </div>

                        <div id="tabs-feed-items-failed">
                            {% include 'reviewers/reviews/feed-item/table.twig' with {'FeedItems': FeedItemsFailed} %}
                        </div>

                    </div>

                </div>

            </div>

        </div>

        <div class="col-xs-12 col-sm-4 col-md-4">

            <br>
            {% include 'modules/tables/slick-header-spaced.twig' with {'titleText': 'Feed status'} %}
            {% if IsYoutubeChannel %}
                <div class="alert alert-info">
                    <strong>As you're submitting Youtube videos, you don't need to worry about this section</strong>.
                    Keep those reviews coming. We really appreciate everything you do! &hearts;
                </div>
            {% elseif PartnerFeed is empty %}
                <div class="alert alert-danger">
                    <strong>We don't have a feed for your site</strong>. This means your reviews won't be imported.
                    Get in touch and let's get things up and running.
                </div>
            {% elseif PartnerData.isLastReviewHistoric() %}
                <div class="alert alert-warning">
                    <strong>We haven't had any reviews from your site recently</strong>.
                    Have a look at the list we've imported and let us know if we've missed any.
                </div>
            {% else %}
                <div class="alert alert-info">
                    <strong>Your feed URL looks good!</strong> Keep those reviews coming. We really appreciate
                    everything you do! &hearts;
                </div>
                <div class="alert alert-success">
                    Have a look at your <a href="{{ route('reviewers.feed-health.landing') }}">feed health</a> status page
                    to see if we've had any issues importing your reviews.
                </div>
            {% endif %}

        </div>

    </div>

<script>
    $('#tabs').tabs();
</script>

{% endblock page_inner %}