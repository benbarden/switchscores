{% extends 'theme/staff-b5/layout-default.twig' %}

{% block page_inner %}

<div class="row">

    <div class="col-md-4">

        {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Submissions'} %}

        <table class="table">
            <tbody>
            {% if auth_user().hasRole('Reviews manager') or auth_user().isOwner() %}
                <tr>
                    <td>
                        <a href="{{ route('staff.reviews.feed-items.list') }}">Feeds: Reviews</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.reviews.feed-items.list') }}" class="h4">{{ UnprocessedFeedReviewItemsCount }}</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a href="{{ route('staff.reviews.review-drafts.showPending') }}">Review drafts</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.reviews.review-drafts.showPending') }}" class="h4">{{ ReviewDraftUnprocessedCount }}</a>
                    </td>
                </tr>
            {% endif %}
            {% if auth_user().hasRole('Reviews manager') or auth_user().isOwner() %}
                <tr>
                    <td>
                        <a href="{{ route('staff.reviews.quick-reviews.list') }}">Quick reviews</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.reviews.quick-reviews.list') }}" class="h4">{{ PendingQuickReviewCount }}</a>
                    </td>
                </tr>
            {% endif %}
            {% if auth_user().hasRole('Category manager') or auth_user().isOwner() %}
                <tr>
                    <td>
                        <a href="{{ route('staff.categorisation.game-category-suggestions.index') }}">Game category suggestions</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.categorisation.game-category-suggestions.index') }}" class="h4">{{ PendingGameCategorySuggestionCount }}</a>
                    </td>
                </tr>
            {% endif %}
            {% if auth_user().hasRole('Games manager') or auth_user().isOwner() %}
                <tr>
                    <td>
                        <a href="{{ route('staff.games.featured-games.list') }}">Featured games</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.games.featured-games.list') }}" class="h4">{{ PendingFeaturedGameCount }}</a>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>

        {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Games to add'} %}

        <table class="table">
            <tbody>
            {% if auth_user().hasRole('Games manager') or auth_user().isOwner() %}
            <tr>
                <td>
                    <a href="{{ route('staff.games.list.games-to-release')}}">Games to release</a>
                </td>
                <td class="text-end">
                    <a href="{{ route('staff.games.list.games-to-release')}}" class="h4">{{ GamesForReleaseCount }}</a>
                </td>
            </tr>
            {% endif %}
            {% if auth_user().hasRole('Data source manager') or auth_user().isOwner() %}
                <tr>
                    <td>
                        <a href="{{ route('staff.data-sources.nintendo-co-uk.unlinked') }}">Nintendo.co.uk API: Unlinked items</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.data-sources.nintendo-co-uk.unlinked') }}" class="h4">{{ NintendoCoUkUnlinkedCount }}</a>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>

        {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Missing data'} %}

        <table class="table">
            <tbody>
            <tr>
                <td>
                    <a href="{{ route('staff.games.list.no-category') }}">
                        No category - all games
                    </a>
                </td>
                <td class="text-end">
                    <span class="h4">{{ NoCategoryAllGamesCount }}</span>
                </td>
            </tr>
            <tr>
                <td>
                    <a href="{{ route('staff.games.list.no-tag') }}">
                        No tag
                    </a>
                </td>
                <td class="text-end">
                    <span class="h4">{{ NoTagCount }}</span>
                </td>
            </tr>
            <tr>
                <td>
                    <a href="{{ route('staff.partners.data-cleanup.games-with-missing-publisher') }}">Games with missing publisher</a>
                </td>
                <td class="text-end">
                    <a href="{{ route('staff.partners.data-cleanup.games-with-missing-publisher') }}" class="h4">{{ PublisherMissingCount }}</a>
                </td>
            </tr>
            </tbody>
        </table>

    </div>

    <div class="col-md-4">

        {% if auth_user().hasRole('Games manager') or auth_user().isOwner() %}
            {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'New games'} %}
            {% if RecentlyAddedGames.count > 0 %}
                <div class="col-md-12">
                    {% for item in RecentlyAddedGames %}
                        <div class="row" style="margin-top: 6px;">
                            <div class="col-md-3 col-sm-3 col-xs-3">
                                {% include 'modules/game/packshot/square.twig' with {'item': item} %}
                            </div>
                            <div class="col-md-9 col-sm-9 col-xs-9">
                                {% include 'modules/game/table/staff-game-title.twig' with {'item': item} %}
                                <br>
                                <small>
                                    Added: {{ item.created_at|date('d M @ H:i') }}
                                </small>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p>No items found!</p>
            {% endif %}
            <p><a href="{{ route('staff.games.list.recently-added') }}">View all recently added games</a>.</p>
        {% endif %}

    </div>

    <div class="col-md-4">

        {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Invite codes'} %}
        <table class="table">
            <tbody>
            <tr>
                <td>
                    <a href="{{ route('staff.invite-code.list') }}">Invite codes</a>
                </td>
                <td></td>
            </tr>
            </tbody>
        </table>

        {% if auth_user().isOwner() %}
            {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Owner links'} %}
            <table class="table">
                <tbody>
                <tr>
                    <td>
                        <a href="{{ route('owner.user.list') }}">Registered users</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('owner.user.list') }}" class="h4">{{ RegisteredUserCount }}</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a href="{{ route('owner.audit.index') }}">Audit</a>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td>
                        <a href="{{ route('staff.stats.dashboard') }}">Stats</a>
                    </td>
                    <td></td>
                </tr>
                </tbody>
            </table>
        {% endif %}

        {% if auth_user().isOwner() %}
            {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Data integrity'} %}

            <table class="table">
                <tbody>
                <tr>
                    <td>
                        <a href="{{ route('staff.data-quality.duplicate-reviews') }}">Duplicate reviews</a>
                    </td>
                    <td class="text-end">
                        <a href="{{ route('staff.data-quality.duplicate-reviews') }}" class="h4">{{ DuplicateReviewsCount }}</a>
                    </td>
                </tr>
                </tbody>
            </table>
        {% endif %}

        {% if auth_user().hasRole('Reviews manager') or auth_user().isOwner() %}
            {% include 'modules/tables/slick-header-title.twig' with {'titleText': 'Recent imports'} %}
            {% if ReviewFeedImportList.count > 0 %}
                <table class="table table-responsive">
                    <thead>
                    <tr>
                        <th class="text-center">Day of week</th>
                        <th class="text-center">Items</th>
                        <th class="text-center">Date</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in ReviewFeedImportList %}
                        <tr>
                            <td class="text-center">
                                {{ item.created_at|date('l') }}
                            </td>
                            <td class="text-center">
                                <a href="{{ route('staff.reviews.feed-imports.item-list', {'feedImport': item}) }}">
                                    {{ item.feedItems.count() }}
                                </a>
                            </td>
                            <td class="text-center">
                                {{ item.created_at|date('Y-m-d') }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No items found!</p>
            {% endif %}
            <p><a href="{{ route('staff.reviews.feed-imports.list') }}">View all imports</a>.</p>
        {% endif %}

    </div>

</div>

{% endblock page_inner %}
